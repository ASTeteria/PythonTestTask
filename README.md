# üöÄ FastAPI WebSocket Server with Graceful Shutdown

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î WebSocket-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤—ñ **FastAPI**, —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î:

- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ —á–µ—Ä–µ–∑ WebSocket
- –í—ñ–¥–ø—Ä–∞–≤–∫—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥
- –ö–æ—Ä–µ–∫—Ç–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ (graceful shutdown)
- –ü—Ä–æ—Å—Ç–∏–π HTML-–∫–ª—ñ—î–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

---

## üß© –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **Python 3.10+**
- **FastAPI**
- **Uvicorn**
- **WebSocket**
- **asyncio**
- **HTML/JavaScript (–Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞)**

---

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
git clone https://github.com/your-username/fastapi-websocket-shutdown.git
cd fastapi-websocket-shutdown
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

```bash
python -m venv venv
source venv/bin/activate    # Linux/macOS
venv\Scripts\activate.bat   # Windows
```

### 3. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

> ‚ùó **–£–≤–∞–≥–∞:** –î–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ `graceful shutdown` —Å–ª—ñ–¥ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä –∑ –æ–¥–Ω–∏–º –≤–æ—Ä–∫–µ—Ä–æ–º.

```bash
uvicorn main:app --host 0.0.0.0 --port 8000 --workers 1
```

---

## üåê –ö–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–í—ñ–¥–∫—Ä–∏–π —É –±—Ä–∞—É–∑–µ—Ä—ñ:

```
http://localhost:8000/static/client.html
```

–ö–ª—ñ—î–Ω—Ç –¥–æ–∑–≤–æ–ª—è—î:
- üîå –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ WebSocket
- ‚ùå –í—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
- üì© –û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥

---

## ‚öôÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
.
‚îú‚îÄ‚îÄ main.py                  # –ó–∞–ø—É—Å–∫ FastAPI —Ç–∞ —Ä–æ—É—Ç WebSocket
‚îú‚îÄ‚îÄ connection_manager.py    # –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–∫—Ç–∏–≤–Ω–∏—Ö WebSocket-–∑'—î–¥–Ω–∞–Ω—å
‚îú‚îÄ‚îÄ broadcaster.py           # –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–ª—ñ—î–Ω—Ç–∞–º –∫–æ–∂–Ω—ñ 10 —Å–µ–∫
‚îú‚îÄ‚îÄ shutdown_handler.py      # –û–±—Ä–æ–±–∫–∞ graceful shutdown
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îî‚îÄ‚îÄ client.html          # HTML-–∫–ª—ñ—î–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ requirements.txt         # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îî‚îÄ‚îÄ README.md                # –¶–µ–π —Ñ–∞–π–ª
```

---

## üì° –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î?

- –ö–ª—ñ—î–Ω—Ç –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `/ws`
- –°–µ—Ä–≤–µ—Ä –∫–æ–∂–Ω—ñ **10 —Å–µ–∫—É–Ω–¥** –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `üîî Test notification`
- –ü—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —Å–∏–≥–Ω–∞–ª—É `SIGINT` –∞–±–æ `SIGTERM`, —Å–µ—Ä–≤–µ—Ä:
  - –û—á—ñ–∫—É—î –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω—å –¥–æ 30 —Ö–≤
  - –Ø–∫—â–æ –≤—Å—ñ –∫–ª—ñ—î–Ω—Ç–∏ –≤—ñ–¥–∫–ª—é—á–∏–ª–∏—Å—å ‚Äî –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è —Ä–∞–Ω—ñ—à–µ
  - –Ü–Ω–∞–∫—à–µ ‚Äî –ø—Ä–∏–º—É—Å–æ–≤–æ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ 30 —Ö–≤

---

## üìÑ requirements.txt

```
fastapi
uvicorn[standard]
```

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

1. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä.
2. –í—ñ–¥–∫—Ä–∏–π –∫—ñ–ª—å–∫–∞ –≤–∫–ª–∞–¥–æ–∫ `http://localhost:8000/static/client.html`.
3. –ü–µ—Ä–µ–≤—ñ—Ä —Ä–æ–±–æ—Ç—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.
4. –ó—É–ø–∏–Ω–∏ —Å–µ—Ä–≤–µ—Ä ‚Äî –ø–æ–±–∞—á–∏—à –ª–æ–≥—ñ–∫—É graceful shutdown —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ.

